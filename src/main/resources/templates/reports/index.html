<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{fragments/layout :: layout(~{::section})}">
<section class="mt-3">
	<h2>Sales Reports</h2>

	<form class="row g-3 mb-3" method="get">
		<div class="col-md-4">
			<label class="form-label">Daily Date</label>
			<input class="form-control" type="date" name="date" th:value="${date}" />
		</div>
		<div class="col-md-2">
			<label class="form-label">Year</label>
			<input class="form-control" type="number" name="year" min="2000" th:value="${year}" />
		</div>
		<div class="col-md-2">
			<label class="form-label">Month</label>
			<input class="form-control" type="number" name="month" min="1" max="12" th:value="${month}" />
		</div>
		<div class="col-md-4 d-flex align-items-end gap-2">
			<button class="btn btn-outline-secondary" type="submit">Refresh</button>
			<a class="btn btn-success" th:href="@{'/reports/export'(date=${date},year=${year},month=${month})}">Export CSV</a>
		</div>
	</form>

	<div class="row">
		<div class="col-md-6">
			<h5>Daily (<span th:text="${date}"></span>)</h5>
			<table class="table table-sm table-striped">
				<thead>
				<tr>
					<th>DateTime</th>
					<th>Book</th>
					<th>Qty</th>
					<th>Total</th>
				</tr>
				</thead>
				<tbody>
				<tr th:each="s : ${daily}">
					<td th:text="${#temporals.format(s.saleDateTime, 'yyyy-MM-dd HH:mm')}"></td>
					<td th:text="${s.book.title}"></td>
					<td th:text="${s.quantity}"></td>
					<td th:text="${#numbers.formatDecimal(s.totalAmount, 1, 'COMMA', 2, 'POINT')}"></td>
				</tr>
				</tbody>
			</table>
			<p><strong>Daily Total: </strong><span th:text="${#numbers.formatDecimal(dailyTotal, 1, 'COMMA', 2, 'POINT')}"></span></p>
		</div>
		<div class="col-md-6">
			<h5>Monthly (<span th:text="${year}"></span>-<span th:text="${month}"></span>)</h5>
			<table class="table table-sm table-striped">
				<thead>
				<tr>
					<th>DateTime</th>
					<th>Book</th>
					<th>Qty</th>
					<th>Total</th>
				</tr>
				</thead>
				<tbody>
				<tr th:each="s : ${monthly}">
					<td th:text="${#temporals.format(s.saleDateTime, 'yyyy-MM-dd HH:mm')}"></td>
					<td th:text="${s.book.title}"></td>
					<td th:text="${s.quantity}"></td>
					<td th:text="${#numbers.formatDecimal(s.totalAmount, 1, 'COMMA', 2, 'POINT')}"></td>
				</tr>
				</tbody>
			</table>
			<p><strong>Monthly Total: </strong><span th:text="${#numbers.formatDecimal(monthlyTotal, 1, 'COMMA', 2, 'POINT')}"></span></p>
		</div>
	</div>

	<hr/>
	<p><strong>All-Time Total Sales: </strong><span th:text="${#numbers.formatDecimal(totalAll, 1, 'COMMA', 2, 'POINT')}"></span></p>
</section>
</html>


